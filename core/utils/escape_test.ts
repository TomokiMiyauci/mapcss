import { escapeSelector } from "./escape.ts";
import { expect, ParamReturn, test } from "../../dev_deps.ts";

test("escapeSelector", () => {
  const table: ParamReturn<typeof escapeSelector>[] = [
    ["\0", "\uFFFD"],
    ["a\0", "a\uFFFD"],
    ["\0b", "\uFFFDb"],
    ["a\0b", "a\uFFFDb"],
    ["\uFFFD", "\uFFFD"],
    ["\uFFFDb", "\uFFFDb"],
    ["a\uFFFD", "a\uFFFD"],
    ["a\uFFFDb", "a\uFFFDb"],
    ["", ""],
    ["\x01\x02\x1E\x1F", "\\1 \\2 \\1e \\1f "],
    ["0a", "\\30 a"],
    ["1a", "\\31 a"],
    ["2a", "\\32 a"],
    ["3a", "\\33 a"],
    ["4a", "\\34 a"],
    ["5a", "\\35 a"],
    ["6a", "\\36 a"],
    ["7a", "\\37 a"],
    ["8a", "\\38 a"],
    ["9a", "\\39 a"],
    ["a0b", "a0b"],
    ["a1b", "a1b"],
    ["a2b", "a2b"],
    ["a3b", "a3b"],
    ["a4b", "a4b"],
    ["a5b", "a5b"],
    ["a6b", "a6b"],
    ["a7b", "a7b"],
    ["a8b", "a8b"],
    ["a9b", "a9b"],
    ["-0a", "-\\30 a"],
    ["-1a", "-\\31 a"],
    ["-2a", "-\\32 a"],
    ["-3a", "-\\33 a"],
    ["-4a", "-\\34 a"],
    ["-5a", "-\\35 a"],
    ["-6a", "-\\36 a"],
    ["-7a", "-\\37 a"],
    ["-8a", "-\\38 a"],
    ["-9a", "-\\39 a"],
    ["-", "\\-"],
    ["--", "--"],
    ["-a", "-a"],
    ["--a", "--a"],
    ["\x80\x2D\x5F\xA9", "\x80\x2D\x5F\xA9"],
    [
      "\x7F\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8A\x8B\x8C\x8D\x8E\x8F\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9A\x9B\x9C\x9D\x9E\x9F",
      "\\7f \x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8A\x8B\x8C\x8D\x8E\x8F\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9A\x9B\x9C\x9D\x9E\x9F",
    ],
    ["\xA0\xA1\xA2", "\xA0\xA1\xA2"],
    ["a0123456789b", "a0123456789b"],
    ["abcdefghijklmnopqrstuvwxyz", "abcdefghijklmnopqrstuvwxyz"],
    ["ABCDEFGHIJKLMNOPQRSTUVWXYZ", "ABCDEFGHIJKLMNOPQRSTUVWXYZ"],
    ["\x20\x21\x78\x79", "\\ \\!xy"],
    ["\uD834\uDF06", "\uD834\uDF06"],
    ["\uDF06", "\uDF06"],
    ["\uD834", "\uD834"],
  ];
  table.forEach(([value, result]) =>
    expect(escapeSelector(value)).toBe(result)
  );
});
